!function(){function t(t,e){this._historyStack=[],this.currIndex=-1,this._itemCap=void 0,this.itemCap=e,this._validatorFn=t?t:function(){return!0}}function e(t){var e=window.getComputedStyle(t),n=xtag.prefix.js+"TransitionDuration";return e.transitionDuration?e.transitionDuration:e[n]}function n(t){if("string"!=typeof t)return 0;var e=/^(\d*\.?\d+)(m?s)$/,n=t.toLowerCase().match(e);if(n){var r=n[1],i=n[2],a=parseFloat(r);if(isNaN(a))throw"value error";if("s"===i)return 1e3*a;if("ms"===i)return a;throw"unit error"}return 0}function r(t,e){return(t%e+e)%e}function i(t){return xtag.queryChildren(t,"x-card")}function a(t,e){var n=i(t);return isNaN(parseInt(e))||0>e||e>=n.length?null:n[e]}function o(t,e){var n=i(t);return n.indexOf(e)}function s(t,r,a,s,u){t.xtag._selectedCard=a;var c=new Date;t.xtag._lastAnimTimestamp=c;var f=function(){c===t.xtag._lastAnimTimestamp&&(l(t),xtag.fireEvent(t,"shuffleend",{detail:{oldCard:r,newCard:a}}))};if(a===r)return f(),void 0;var h=!1,p=!1,v=!1,g=function(){h&&p&&(i(t).forEach(function(t){t.removeAttribute("selected"),t.removeAttribute("leaving")}),r.setAttribute("leaving",!0),a.setAttribute("selected",!0),t.xtag._selectedCard=a,t.selectedIndex=o(t,a),u&&(r.setAttribute("reverse",!0),a.setAttribute("reverse",!0)),xtag.fireEvent(t,"shufflestart",{detail:{oldCard:r,newCard:a}}))},m=function(){v||h&&p&&b()},b=function(){v=!0;var t=!1,i=!1,o=!1,u=function(e){o||(e.target===r?(t=!0,r.removeEventListener("transitionend",u)):e.target===a&&(i=!0,a.removeEventListener("transitionend",u)),t&&i&&(o=!0,f()))};r.addEventListener("transitionend",u),a.addEventListener("transitionend",u);var c=n(e(r)),l=n(e(a)),h=Math.max(c,l),p=1.15,g="none"===s.toLowerCase()?0:Math.ceil(h*p);0===g?(o=!0,r.removeEventListener("transitionend",u),a.removeEventListener("transitionend",u),r.removeAttribute(d),a.removeAttribute(d),f()):(r.removeAttribute(d),a.removeAttribute(d),window.setTimeout(function(){o||(o=!0,r.removeEventListener("transitionend",u),a.removeEventListener("transitionend",u),f())},g))};xtag.skipTransition(r,function(){return r.setAttribute("card-anim-type",s),r.setAttribute(d,!0),h=!0,g(),m},this),xtag.skipTransition(a,function(){return a.setAttribute("card-anim-type",s),a.setAttribute(d,!0),p=!0,g(),m},this)}function u(t,e,n,r,a){var o=t.xtag._selectedCard;if(o===e){var u={detail:{oldCard:o,newCard:e}};return xtag.fireEvent(t,"shufflestart",u),xtag.fireEvent(t,"shuffleend",u),void 0}l(t),void 0===n&&(console.log("defaulting to none transition"),n="none");var c;switch(r){case"forward":c=!1;break;case"reverse":c=!0;break;default:o||(c=!1);var d=i(t);c=d.indexOf(e)<d.indexOf(o)?!0:!1}e.hasAttribute("transition-override")&&(n=e.getAttribute("transition-override")),a||t.xtag.history.pushState(e),s(t,o,e,n,c)}function c(t,e,n,r){var i=a(t,e);if(!i)throw"no card at index "+e;u(t,i,n,r)}function l(t){if(t.xtag._initialized){var e=i(t),n=t.xtag._selectedCard;n&&n.parentNode===t||(n=e.length>0?t.xtag.history&&t.xtag.history.numStates>0?t.xtag.history.currState:e[0]:null),e.forEach(function(t){t.removeAttribute("leaving"),t.removeAttribute(d),t.removeAttribute("card-anim-type"),t.removeAttribute("reverse"),t!==n?t.removeAttribute("selected"):t.setAttribute("selected",!0)}),t.xtag._selectedCard=n,t.selectedIndex=o(t,n)}}var d="_before-animation",f=t.prototype;f.pushState=function(t){if(this.canRedo&&this._historyStack.splice(this.currIndex+1,this._historyStack.length-(this.currIndex+1)),this._historyStack.push(t),this.currIndex=this._historyStack.length-1,this.sanitizeStack(),"none"!==this._itemCap&&this._historyStack.length>this._itemCap){var e=this._historyStack.length;this._historyStack.splice(0,e-this._itemCap),this.currIndex=this._historyStack.length-1}},f.sanitizeStack=function(){for(var t,e=this._validatorFn,n=0;n<this._historyStack.length;){var r=this._historyStack[n];r!==t&&e(r)?(t=r,n++):(this._historyStack.splice(n,1),n<=this.currIndex&&this.currIndex--)}},f.forwards=function(){this.canRedo&&this.currIndex++,this.sanitizeStack()},f.backwards=function(){this.canUndo&&this.currIndex--,this.sanitizeStack()},Object.defineProperties(f,{DEFAULT_CAP:{value:10},itemCap:{get:function(){return this._itemCap},set:function(t){if(void 0===t)this._itemCap=this.DEFAULT_CAP;else if("none"===t)this._itemCap="none";else{var e=parseInt(t,10);if(isNaN(t)||0>=t)throw"attempted to set invalid item cap: "+t;this._itemCap=e}}},canUndo:{get:function(){return this.currIndex>0}},canRedo:{get:function(){return this.currIndex<this._historyStack.length-1}},numStates:{get:function(){return this._historyStack.length}},currState:{get:function(){var t=this.currIndex;return t>=0&&t<this._historyStack.length?this._historyStack[t]:null}}}),xtag.register("x-deck",{lifecycle:{created:function(){var e=this;e.xtag._initialized=!0;var n=function(t){return t.parentNode===e};e.xtag.history=new t(n,t.DEFAULT_CAP),e.xtag._selectedCard=e.xtag._selectedCard?e.xtag._selectedCard:null,e.xtag._lastAnimTimestamp=null,e.xtag.transitionType="scrollLeft";var r=e.getCardAt(e.getAttribute("selected-index"));r&&(e.xtag._selectedCard=r),l(e);var i=e.xtag._selectedCard;i&&e.xtag.history.pushState(i)}},events:{"show:delegate(x-card)":function(){var t=this;t.show()}},accessors:{transitionType:{attribute:{name:"transition-type"},get:function(){return this.xtag.transitionType},set:function(t){this.xtag.transitionType=t}},selectedIndex:{attribute:{skip:!0,name:"selected-index"},get:function(){return o(this,this.xtag._selectedCard)},set:function(t){this.selectedIndex!==t&&c(this,t,"none"),this.setAttribute("selected-index",t)}},historyCap:{attribute:{name:"history-cap"},get:function(){return this.xtag.history.itemCap},set:function(t){this.xtag.history.itemCap=t}},numCards:{get:function(){return this.getAllCards().length}},currHistorySize:{get:function(){return this.xtag.history.numStates}},currHistoryIndex:{get:function(){return this.xtag.history.currIndex}},cards:{get:function(){return this.getAllCards()}},selectedCard:{get:function(){return this.getSelectedCard()}}},methods:{shuffleTo:function(t,e){var n=a(this,t);if(!n)throw"invalid shuffleTo index "+t;var r=this.xtag.transitionType;c(this,t,r,e)},shuffleNext:function(t){t=t?t:"auto";var e=i(this),n=this.xtag._selectedCard,a=e.indexOf(n);a>-1&&this.shuffleTo(r(a+1,e.length),t)},shufflePrev:function(t){t=t?t:"auto";var e=i(this),n=this.xtag._selectedCard,a=e.indexOf(n);a>-1&&this.shuffleTo(r(a-1,e.length),t)},getAllCards:function(){return i(this)},getSelectedCard:function(){return this.xtag._selectedCard},getCardIndex:function(t){return o(this,t)},getCardAt:function(t){return a(this,t)},historyBack:function(t){var e=this.xtag.history;if(e.canUndo){e.backwards();var n=e.currState;n&&u(this,n,this.transitionType,t,!0)}},historyForward:function(t){var e=this.xtag.history;if(e.canRedo){e.forwards();var n=e.currState;n&&u(this,n,this.transitionType,t,!0)}}}}),xtag.register("x-card",{lifecycle:{inserted:function(){var t=this,e=t.parentNode;e&&"x-deck"===e.tagName.toLowerCase()&&(l(e),t.xtag.parentDeck=e,xtag.fireEvent(e,"cardadd",{detail:{card:t}}))},created:function(){var t=this.parentNode;t&&"x-deck"===t.tagName.toLowerCase()&&(this.xtag.parentDeck=t)},removed:function(){var t=this;if(t.xtag.parentDeck){var e=t.xtag.parentDeck;e.xtag.history.sanitizeStack(),l(e),xtag.fireEvent(e,"cardremove",{detail:{card:t}})}}},accessors:{transitionOverride:{attribute:{name:"transition-override"}}},methods:{show:function(){var t=this.parentNode;t===this.xtag.parentDeck&&t.shuffleTo(t.getCardIndex(this))}}})}();