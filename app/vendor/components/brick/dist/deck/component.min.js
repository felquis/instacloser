!function(){function t(t,e){this._historyStack=[],this.currIndex=-1,this._itemCap=void 0,this.itemCap=e,this._validatorFn=t?t:function(){return!0}}function e(t){var e=window.getComputedStyle(t),n=xtag.prefix.js+"TransitionDuration";return e.transitionDuration?e.transitionDuration:e[n]}function n(t){if("string"!=typeof t)return 0;var e=/^(\d*\.?\d+)(m?s)$/,n=t.toLowerCase().match(e);if(n){var r=n[1],i=n[2],o=parseFloat(r);if(isNaN(o))throw"value error";if("s"===i)return 1e3*o;if("ms"===i)return o;throw"unit error"}return 0}function r(t,e){return(t%e+e)%e}function i(t){return xtag.queryChildren(t,"x-card")}function o(t,e){var n=i(t);return 0>e||e>=n.length?null:n[e]}function a(t,e){var n=i(t);return n.indexOf(e)}function s(t,r,o,s,u){t.xtag._selectedCard=o;var l=new Date;t.xtag._lastAnimTimestamp=l;var d=function(){l===t.xtag._lastAnimTimestamp&&(c(t),xtag.fireEvent(t,"shuffleend",{detail:{oldCard:r,newCard:o}}))};if(o===r)return d(),void 0;var f=!1,h=!1,p=!1,v=function(){f&&h&&(i(t).forEach(function(t){t.removeAttribute("selected"),t.removeAttribute("leaving")}),r.setAttribute("leaving",!0),o.setAttribute("selected",!0),t.xtag._selectedCard=o,t.selectedIndex=a(t,o),u&&(r.setAttribute("reverse",!0),o.setAttribute("reverse",!0)),xtag.fireEvent(t,"shufflestart",{detail:{oldCard:r,newCard:o}}))},g=function(){p||f&&h&&m()},m=function(){p=!0;var t=!1,i=!1,a=!1,u=function(e){a||(e.target===r?(t=!0,r.removeEventListener("transitionend",u)):e.target===o&&(i=!0,o.removeEventListener("transitionend",u)),t&&i&&(a=!0,d()))};r.addEventListener("transitionend",u),o.addEventListener("transitionend",u);var l=n(e(r)),c=n(e(o)),f=Math.max(l,c),h=1.15,v="none"===s.toLowerCase()?0:Math.ceil(f*h);0===v?(a=!0,r.removeEventListener("transitionend",u),o.removeEventListener("transitionend",u),r.removeAttribute("before-animation"),o.removeAttribute("before-animation"),d()):(r.removeAttribute("before-animation"),o.removeAttribute("before-animation"),window.setTimeout(function(){a||(a=!0,r.removeEventListener("transitionend",u),o.removeEventListener("transitionend",u),d())},v))};xtag.skipTransition(r,function(){return r.setAttribute("card-anim-type",s),r.setAttribute("before-animation",!0),f=!0,v(),g},this),xtag.skipTransition(o,function(){return o.setAttribute("card-anim-type",s),o.setAttribute("before-animation",!0),h=!0,v(),g},this)}function u(t,e,n,r,o){var a=t.xtag._selectedCard;if(a===e)return xtag.fireEvent(t,"shufflestart",{detail:{oldCard:a,newCard:e}}),xtag.fireEvent(t,"shuffleend",{detail:{oldCard:a,newCard:e}}),void 0;c(t),void 0===n&&(console.log("defaulting to none transition"),n="none");var u;switch(r){case"forward":u=!1;break;case"reverse":u=!0;break;default:a||(u=!1);var l=i(t);u=l.indexOf(e)<l.indexOf(a)?!0:!1}e.hasAttribute("transition-override")&&(n=e.getAttribute("transition-override")),o||t.xtag.history.pushState(e),s(t,a,e,n,u)}function l(t,e,n,r){var i=o(t,e);if(!i)throw"no card at index "+e;u(t,i,n,r)}function c(t){var e=i(t),n=t.xtag._selectedCard;n&&n.parentNode===t||(n=e.length>0?t.xtag.history&&t.xtag.history.numStates>0?t.xtag.history.currState:e[0]:null),e.forEach(function(t){t.removeAttribute("leaving"),t.removeAttribute("before-animation"),t.removeAttribute("card-anim-type"),t.removeAttribute("reverse"),t!==n?t.removeAttribute("selected"):t.setAttribute("selected",!0)}),t.xtag._selectedCard=n,t.selectedIndex=a(t,n)}t.prototype.pushState=function(t){if(this.canRedo&&this._historyStack.splice(this.currIndex+1,this._historyStack.length-(this.currIndex+1)),this._historyStack.push(t),this.currIndex=this._historyStack.length-1,this.sanitizeStack(),"none"!==this._itemCap&&this._historyStack.length>this._itemCap){var e=this._historyStack.length;this._historyStack.splice(0,e-this._itemCap),this.currIndex=this._historyStack.length-1}},t.prototype.sanitizeStack=function(){for(var t,e=this._validatorFn,n=0;n<this._historyStack.length;){var r=this._historyStack[n];r!==t&&e(r)?(t=r,n++):(this._historyStack.splice(n,1),n<=this.currIndex&&this.currIndex--)}},t.prototype.forwards=function(){this.canRedo&&this.currIndex++,this.sanitizeStack()},t.prototype.backwards=function(){this.canUndo&&this.currIndex--,this.sanitizeStack()},Object.defineProperties(t.prototype,{DEFAULT_CAP:{value:10},itemCap:{get:function(){return this._itemCap},set:function(t){if(void 0===t)this._itemCap=this.DEFAULT_CAP;else if("none"===t)this._itemCap="none";else{var e=parseInt(t,10);if(isNaN(t)||0>=t)throw"attempted to set invalid item cap: "+t;this._itemCap=e}}},canUndo:{get:function(){return this.currIndex>0}},canRedo:{get:function(){return this.currIndex<this._historyStack.length-1}},numStates:{get:function(){return this._historyStack.length}},currState:{get:function(){var t=this.currIndex;return t>=0&&t<this._historyStack.length?this._historyStack[t]:null}}}),xtag.register("x-deck",{lifecycle:{created:function(){var e=this,n=function(t){return t.parentNode===e};this.xtag.history=new t(n,t.DEFAULT_CAP),this.xtag._selectedCard=this.xtag._selectedCard?this.xtag._selectedCard:null,this.xtag._lastAnimTimestamp=null,this.xtag.transitionType="scrollLeft",c(this);var r=this.xtag._selectedCard;!this.hasAttribute("selected-index")&&r&&this.xtag.history.pushState(r)}},events:{"show:delegate(x-card)":function(){var t=this;t.show()}},accessors:{transitionType:{attribute:{name:"transition-type"},get:function(){return this.xtag.transitionType},set:function(t){this.xtag.transitionType=t}},selectedIndex:{attribute:{skip:!0,name:"selected-index"},get:function(){return a(this,this.xtag._selectedCard)},set:function(t){this.selectedIndex!==t&&l(this,t,"none"),this.setAttribute("selected-index",t)}},historyCap:{attribute:{name:"history-cap"},get:function(){return this.xtag.history.itemCap},set:function(t){this.xtag.history.itemCap=t}},numCards:{get:function(){return this.getAllCards().length}},currHistorySize:{get:function(){return this.xtag.history.numStates}},currHistoryIndex:{get:function(){return this.xtag.history.currIndex}},cards:{get:function(){return this.getAllCards()}},selectedCard:{get:function(){return this.getSelectedCard()}}},methods:{shuffleTo:function(t,e){var n=o(this,t);if(!n)throw"invalid shuffleTo index "+t;var r=this.xtag.transitionType;l(this,t,r,e)},shuffleNext:function(t){t=t?t:"auto";var e=i(this),n=this.xtag._selectedCard,o=e.indexOf(n);o>-1&&this.shuffleTo(r(o+1,e.length),t)},shufflePrev:function(t){t=t?t:"auto";var e=i(this),n=this.xtag._selectedCard,o=e.indexOf(n);o>-1&&this.shuffleTo(r(o-1,e.length),t)},getAllCards:function(){return i(this)},getSelectedCard:function(){return this.xtag._selectedCard},getCardIndex:function(t){return a(this,t)},getCardAt:function(t){var e=this.getAllCards();return t>=0&&t<e.length?e[t]:null},historyBack:function(t){var e=this.xtag.history;if(e.canUndo){e.backwards();var n=e.currState;n&&u(this,n,this.transitionType,t,!0)}},historyForward:function(t){var e=this.xtag.history;if(e.canRedo){e.forwards();var n=e.currState;n&&u(this,n,this.transitionType,t,!0)}}}}),xtag.register("x-card",{lifecycle:{inserted:function(){var t=this.parentNode;t&&"x-deck"===t.tagName.toLowerCase()&&(c(t),this.xtag.parentDeck=t)},created:function(){var t=this.parentNode;t&&"x-deck"===t.tagName.toLowerCase()&&(c(t),this.xtag.parentDeck=t)},removed:function(){if(this.xtag.parentDeck){var t=this.xtag.parentDeck;t.xtag.history.sanitizeStack(),c(t)}}},accessors:{transitionOverride:{attribute:{name:"transition-override"}}},methods:{show:function(){var t=this.parentNode;t===this.xtag.parentDeck&&t.shuffleTo(t.getCardIndex(this))}}})}();